-- FreeFem++ v4.400003 (jeu. 12 d√©c. 2019 13:58:15 - git v4.4-3-9-gc37e08e1)
 Load: lg_fem lg_mesh lg_mesh3 eigenvalue
    1 : // G. Allaire, B. Bogosel
    2 : // MAP562, January 2019
    3 :
    4 : // Optimization using rank-1 laminates in 2D
    5 : // by optimizing in theta and phi simultaneously
    6 :
    7 :
    8 : int niter=400;                  // Number of iteration
    9 : int npen = 50;
   10 : int n = 5;                              // Mesh size
   11 : real pas=0.1 ;                  // Stepsize
   12 : real initpas = pas;
   13 : int inddico ;
   14 : real objectif;                  // Objective function
   15 : real objectifold ;
   16 : real volume0=0.7;                       // Initial volume
   17 : real volume;
 *** Warning  The identifier volume hide a Global identifier
 
   18 : string legende;                 // LÈgende pour les sorties graphiques
   19 :
   20 : int accept=0;
   21 :
   22 : real TOL = 1e-6;
   23 : real Cpen = 0;
   24 : int pen = 0;
   25 :
   26 : real alpha=1;
   27 : real beta=10;
   28 : func theta0=0.5;//(x>0.1)*(x<0.9)*(y<0.9) ;
   29 :
   30 : verbosity = 0;
   31 :
   32 :
   33 :
   34 :
   35 :
   36 : // Maximum and minimal width of the plate//
   37 : real u0=0;
   38 : real hmin=0.001;
   39 : real hmax=1.0;
   40 : real hmoy=0.3;  // initialization with a constant function
   41 : func h0=hmoy;
   42 :
   43 : real[int] vviso;
   44 : real lb = 0.;
   45 : real ub = 1.;
   46 : int nb = 32;
   47 : vviso=lb:(ub-lb)/nb:ub;
   48 :
   49 :
   50 : // Construct the mesh //
   51 : mesh Th ;
   52 :
   53 : int GammaD=1,GammaN=2,Gamma=3;
   54 :
   55 : border bd(t=0,1)   { x=1; y=t;label=Gamma; };     // Right boundary
   56 : border bg(t=1,0)   { x=0; y=t;label=Gamma; };     // Left boundary
   57 : border bs(t=1,0)   { x=t; y=1;label=GammaN; };     // Top boundary
   58 : border b1(t=0,0.1)   { x=t; y=0;label=GammaD; };   // Bottom boundary
   59 : border b2(t=0.1,0.9)   { x=t; y=0;label=Gamma; }; // Inner boundary
   60 : border b3(t=0.9,1)   { x=t; y=0;label=GammaD; };   // Inner boundary
   61 :
   62 :
   63 : //////////////////////////////
   64 : // Construction of the mesh //
   65 : //////////////////////////////
   66 : Th= buildmesh (bd(10*n)+bs(10*n)+bg(10*n)+b1(1*n)+b2(8*n)+b3(1*n));
   67 : plot(Th,wait=0);
   68 :
   69 :
   70 : plot(Th,wait=1);
   71 :
   72 : fespace Vh0(Th,P0);//Definition of the P0 space
   73 : fespace Vh1(Th,P1);
   74 : fespace Vh(Th,P2);
   75 :
   76 : Vh thetav;
   77 : Vh u,w,p,uold;
   78 :
   79 : Vh0 theta;
   80 : Vh0 ang=0.5*pi;//*(abs(x-0.5)+0.1*abs(y));
   81 : plot(ang,fill=1,wait=0);
   82 : theta = theta0;
   83 :
   84 : // Macro for truncation
   85 : macro trunc(u,mm,MM) min(max(u,mm),MM) )  // END of macro
   86 :
   87 : // Macro for projection on the integral constraint
   88 :
   89 : // !!!! Do not write comments with "//" in macros since this
   90 : // terminates a macro in FreeFem. Use /*...*/ instead if you want
  109 # } )  // END of macrohmin,hmax); < endl;*/ << v0-u0 << endl;*/
  110 :
  111 : //theta = 1/Th.area*int2d(Th)(theta);
  112 : proj(theta,volume0/Th.area,Vh0)
   92 @
   93 @
   94 @
   95 @
   96 @
   97 @
   98 @
   99 @
  100 @
  101 @
  102 @
  103 @
  104 @
  105 @      /*cout << tmin << " " << tmax << " " << v0-u0 << endl;*/
  106 @      /*cout << v0 << " " << u0 << endl;*/
  107 @
  108 @
  109 @  {
   92 @    real tmin = hmin-theta[].linfty,tmax = hmax+theta[].linfty;
   93 @    theta  = trunc(theta,hmin,hmax)  min(max(theta,hmin),hmax);
   94 @    real v0 = 1/Th.area*int2d(Th)(theta);
   95 @    while(tmax-tmin>TOL&&abs(v0-volume0/Th.area)>TOL){
   96 @      real tmid = 0.5*(tmin+tmax);
   97 @      Vh0 testu = trunc(tmid+theta,hmin,hmax)  min(max(tmid+theta,hmin),hmax);
   98 @      v0 = 1/Th.area*int2d(Th)(testu);
   99 @      if(v0<volume0/Th.area){
  100 @        tmin = tmid;
  101 @      }
  102 @      else{
  103 @        tmax = tmid;
  104 @      }
  105 @      /*cout << tmin << " " << tmax << " " << v0-u0 << endl;*/
  106 @      /*cout << v0 << " " << u0 << endl;*/
  107 @    }
  108 @    theta = trunc(theta+tmin,hmin,hmax)  min(max(theta+tmin,hmin),hmax);
  109 @ };
  113 : plot(theta,fill=1,wait=0);
  114 :
  115 : // Parameters //
  116 :
  117 :
  118 : func g = 1;
  119 :
  120 : // Macros
  121 :
  122 : macro grad(u) [dx(u),dy(u)] )  //
  123 : // Define the PDE //
  124 :
  125 : macro lp() (alpha*theta+beta*(1-theta))//
  126 : macro lm() 1/(1/alpha*theta+1/beta*(1-theta))//
  127 : macro dlp() (alpha-beta)//
  128 : macro dlm() (-(1/alpha-1/beta)/(1/alpha*theta+1/beta*(1-theta))^2)////
  129 : //macro dlm() (beta-alpha)/((theta*(beta-alpha)+alpha)*(theta*(beta-alpha)+alpha)*alpha*beta)//
  130 :
  131 : problem heat(u,w) =
  132 :     int2d(Th)(
  133 :     (lp  (alpha*theta+beta*(1-theta))*(cos(ang)^2*dx(u)-cos(ang)*sin(ang)*dy(u))
  134 :     +lm  1/(1/alpha*theta+1/beta*(1-theta))*(sin(ang)^2*dx(u)+cos(ang)*sin(ang)*dy(u)))*dx(w)
  135 :    +(lp  (alpha*theta+beta*(1-theta))*(-cos(ang)*sin(ang)*dx(u)+sin(ang)^2*dy(u))
  136 :     +lm  1/(1/alpha*theta+1/beta*(1-theta))*(sin(ang)*cos(ang)*dx(u)+cos(ang)^2*dy(u)))*dy(w)
  137 :     )
  138 :    -int1d(Th,GammaN)(g*w)
  139 :     +on(GammaD,u=0)
  140 : ;
  141 :
  142 : // Define the adjoint state //
  143 : problem adjoint(p,w) =
  144 :     int2d(Th)(
  145 :     (lp  (alpha*theta+beta*(1-theta))*(cos(ang)^2*dx(p)-cos(ang)*sin(ang)*dy(p))
  146 :     +lm  1/(1/alpha*theta+1/beta*(1-theta))*(sin(ang)^2*dx(p)+cos(ang)*sin(ang)*dy(p)))*dx(w)
  147 :   +( lp  (alpha*theta+beta*(1-theta))*(-cos(ang)*sin(ang)*dx(p)+sin(ang)^2*dy(p))
  148 :     +lm  1/(1/alpha*theta+1/beta*(1-theta))*(sin(ang)*cos(ang)*dx(p)+cos(ang)^2*dy(p)))*dy(w))
  149 :    +int1d(Th,GammaN)( g*w )
  150 :    +on(GammaD,p=0)
  151 : ;
  152 :
  153 :
  154 : // Compute initial volume //
  155 : volume0=int2d(Th)(theta);
  156 :
  157 :
  158 : // Initial objective function //
  159 :
  160 :
  161 : heat;
  162 : plot(u,fill=1,wait=1,cmm="Initial temperature");
  163 : objectif=int1d(Th,GammaN)(g*u);
  164 :
  165 : cout<<"Initialization. Objective: "<<objectif<<" Volume: "<<volume0<<endl;
  166 :
  167 :
  168 : // Adjoint and initial gradient  //
  169 :
  170 : adjoint ;
  171 : plot(p,fill=1,wait=1,cmm="Initial adjoint");
  172 :
  173 : // computing gradients w.r.t. phi and theta
  174 :
  175 : // macros are useful here, since we have long formulas
  176 : // that we use multiple times...
  177 : Vh0 gradphi;
  183 #     +lm*((cos(ang)^2-sin(ang)^2)*dx(u)-2*sin(ang)*cos(ang)*dy(u)))*dy(p);//
  184 :
  185 : Vh0 gradtheta;
  191 #     +dlm*(sin(ang)*cos(ang)*dx(u)+cos(ang)^2*dy(u)))*dy(p);//
  192 :
  193 : dPhi
  179 @
  180 @
  181 @
  182 @
  183 @
  179 @   gradphi =
  180 @    (lp  (alpha*theta+beta*(1-theta))*(-2*cos(ang)*sin(ang)*dx(u)-(cos(ang)^2-sin(ang)^2)*dy(u))
  181 @     +lm  1/(1/alpha*theta+1/beta*(1-theta))*(2*sin(ang)*cos(ang)*dx(u)+(cos(ang)^2-sin(ang)^2)*dy(u)))*dx(p)
  182 @    +(lp  (alpha*theta+beta*(1-theta))*(-(cos(ang)^2-sin(ang)^2)*dx(u)+2*sin(ang)*cos(ang)*dy(u))
  183 @     +lm  1/(1/alpha*theta+1/beta*(1-theta))*((cos(ang)^2-sin(ang)^2)*dx(u)-2*sin(ang)*cos(ang)*dy(u)))*dy(p);;
  194 : dTheta
  187 @
  188 @
  189 @
  190 @
  191 @
  187 @    gradtheta  =
  188 @     (dlp  (alpha-beta)*(cos(ang)^2*dx(u)-cos(ang)*sin(ang)*dy(u))
  189 @     +dlm  (-(1/alpha-1/beta)/(1/alpha*theta+1/beta*(1-theta))^2)*(sin(ang)^2*dx(u)+cos(ang)*sin(ang)*dy(u)))*dx(ê±mp)
  190 @    +(dlp  (alpha-beta)*(-cos(ang)*sin(ang)*dx(u)+sin(ang)^2*dy(u))
  191 @     +dlm  (-(1/alpha-1/beta)/(1/alpha*theta+1/beta*(1-theta))^2)*(sin(ang)*cos(ang)*dx(u)+cos(ang)^2*dy(u)))*dy(ê±mp);;
  195 :
  196 : real norgrad=int2d(Th)(gradphi*gradphi)+int2d(Th)(gradtheta*gradtheta);
  197 : norgrad=sqrt(norgrad) ;
  198 : cout << "Gradient: " << norgrad   << endl ;
  199 : //initpas=pas/norgrad ;
  200 : cout << "First step "<< pas << endl;
  201 :
  202 : int iter;
  203 :
  204 :
  205 :
  206 : proj(theta,volume0/Th.area,Vh0)
   92 @
   93 @
   94 @
   95 @
   96 @
   97 @
   98 @
   99 @
  100 @
  101 @
  102 @
  103 @
  104 @
  105 @      /*cout << tmin << " " << tmax << " " << v0-u0 << endl;*/
  106 @      /*cout << v0 << " " << u0 << endl;*/
  107 @
  108 @
  109 @  {
   92 @    real tmin = hmin-theta[].linfty,tmax = hmax+theta[].linfty;
   93 @    theta  = trunc(theta,hmin,hmax)  min(max(theta,hmin),hmax);
   94 @    real v0 = 1/Th.area*int2d(Th)(theta);
   95 @    while(tmax-tmin>TOL&&abs(v0-volume0/Th.area)>TOL){
   96 @      real tmid = 0.5*(tmin+tmax);
   97 @      Vh0 testu = trunc(tmid+theta,hmin,hmax)  min(max(tmid+theta,hmin),hmax);
   98 @      v0 = 1/Th.area*int2d(Th)(testu);
   99 @      if(v0<volume0/Th.area){
  100 @        tmin = tmid;
  101 @      }
  102 @      else{
  103 @        tmax = tmid;
  104 @      }
  105 @      /*cout << tmin << " " << tmax << " " << v0-u0 << endl;*/
  106 @      /*cout << v0 << " " << u0 << endl;*/
  107 @    }
  108 @    theta = trunc(theta+tmin,hmin,hmax)  min(max(theta+tmin,hmin),hmax);
  109 @ };
  207 :
  208 : real[int] vals(niter);
  209 :
  210 : Vh pold = p;
  211 : Vh0 thetaold,angold;
  212 :
  213 :
  214 : thetaold = theta ;
  215 : angold   = ang;
  216 :
  217 :
  218 : uold = u ;
  219 : objectifold=int1d(Th,GammaN)(g*u);
  220 : //reg;
  221 :
  222 :
  223 :
  224 : // Optimization loop
  225 : for (iter=1;iter<=niter;iter=iter+1)
  226 : {
  227 : cout <<"Iteration " <<iter <<" ----------------------------------------" <<endl;
  228 :
  229 : accept = 0; // variable to accept by default
  230 : if(iter == npen){
  231 :  Cpen = 1;
  232 :  accept = 1;  // accept this iteration
  233 : }
  234 :
  235 : if(iter == (npen+100)){
  236 :  Cpen = Cpen*2;// increase penalization constant
  237 :  accept = 1;  // accept this iteration
  238 : }
  239 :
  240 :
  241 :
  242 : real Gtheta = sqrt(int2d(Th)(gradtheta^2));
  243 : real Gphi   = sqrt(int2d(Th)(gradphi^2));
  244 :
  245 : cout << "          Grad comparison: " << Gtheta << " " << Gphi << endl;
  246 :
  247 :
  248 : theta = thetaold - pas*gradtheta;
  249 :
  250 : proj(theta,volume0/Th.area,Vh0)
   92 @
   93 @
   94 @
   95 @
   96 @
   97 @
   98 @
   99 @
  100 @
  101 @
  102 @
  103 @
  104 @
  105 @      /*cout << tmin << " " << tmax << " " << v0-u0 << endl;*/
  106 @      /*cout << v0 << " " << u0 << endl;*/
  107 @
  108 @
  109 @  {
   92 @    real tmin = hmin-theta[].linfty,tmax = hmax+theta[].linfty;
   93 @    theta  = trunc(theta,hmin,hmax)  min(max(theta,hmin),hmax);
   94 @    real v0 = 1/Th.area*int2d(Th)(theta);
   95 @    while(tmax-tmin>TOL&&abs(v0-volume0/Th.area)>TOL){
   96 @      real tmid = 0.5*(tmin+tmax);
   97 @      Vh0 testu = trunc(tmid+theta,hmin,hmax)  min(max(tmid+theta,hmin),hmax);
   98 @      v0 = 1/Th.area*int2d(Th)(testu);
   99 @      if(v0<volume0/Th.area){
  100 @        tmin = tmid;
  101 @      }
  102 @      else{
  103 @        tmax = tmid;
  104 @      }
  105 @      /*cout << tmin << " " << tmax << " " << v0-u0 << endl;*/
  106 @      /*cout << v0 << " " << u0 << endl;*/
  107 @    }
  108 @    theta = trunc(theta+tmin,hmin,hmax)  min(max(theta+tmin,hmin),hmax);
  109 @ };
  251 :
  252 : ang = angold-pas*gradphi;
  253 :
  254 : // Solve the conductivity equation
  255 : heat;
  256 :
  257 : //Compute the objective function
  258 : objectif=int1d(Th,GammaN)(g*u);
  259 : if(iter>=npen){// modify objective when using penalization
  260 :   objectif=int1d(Th,GammaN)(g*u)+Cpen*int2d(Th)(theta*(1-theta));
  261 : }
  262 : vals[iter-1] = objectif;
  263 :
  264 : if (objectif > objectifold && accept== 0)
  265 : {
  266 : // if we do not descent we refuse the step
  267 :   pas = pas / 2. ;
  268 :   cout << "==========REJECT: new step=" << pas << endl ;
  269 :   u = uold;
  270 :   p = pold;
  271 :   cout<<  "==========Cost: "<<objectif<<" Old cost: " << objectifold << "  Volume: "<<volume<<endl;
  272 :   objectif = objectifold ;
  273 :   theta = thetaold;
  274 :   ang   = angold;
  275 :   //dPhi;
  276 :   //dTheta;
  277 : }
  278 : else
  279 : {
  280 : // on accepte le pas
  281 :   pas = pas * 1.1 ;
  282 :   cout << "          New step=" << pas << endl ;
  283 :
  284 :   cout << "    Objective: " << objectif   << endl ;
  285 :    cout<< "    Volume: "<<volume<<endl;
  286 :    legende="Iteration "+iter+", Cost "+objectif+", Volume="+volume;
  287 :    //plot(Th,h,fill=1,value=0,viso=vviso,cmm=legende,wait=0);
  288 :    //plot(u,fill=1,value=1,cmm="Heat distribution");
  289 :    Vh thetb = 1-theta;
  290 :    thetaold = theta;
  291 :    angold   = ang;
  292 :    pold = p;
  293 :    uold = u;
  294 :    thetav = thetb;
  295 :    plot(thetb,fill=1,value=1,cmm="Plot of the density: theta",wait=0,WindowIndex=0);
  296 :    plot(ang,fill=1,value=1,cmm="Plot of the angle: phi",wait=0,WindowIndex=1);
  297 :
  298 :   // Compute the gradient using the adjoint method //
  299 :   //adjoint ;   // uncomment this when you need to compute the adjoint
  300 :   p = -u;       // adjoint for the compliance
  301 :
  302 :   objectifold = objectif;
  303 :
  304 :   dPhi
  179 @
  180 @
  181 @
  182 @
  183 @
  179 @   gradphi =
  180 @    (lp  (alpha*theta+beta*(1-theta))*(-2*cos(ang)*sin(ang)*dx(u)-(cos(ang)^2-sin(ang)^2)*dy(u))
  181 @     +lm  1/(1/alpha*theta+1/beta*(1-theta))*(2*sin(ang)*cos(ang)*dx(u)+(cos(ang)^2-sin(ang)^2)*dy(u)))*dx(p)
  182 @    +(lp  (alpha*theta+beta*(1-theta))*(-(cos(ang)^2-sin(ang)^2)*dx(u)+2*sin(ang)*cos(ang)*dy(u))
  183 @     +lm  1/(1/alpha*theta+1/beta*(1-theta))*((cos(ang)^2-sin(ang)^2)*dx(u)-2*sin(ang)*cos(ang)*dy(u)))*dy(p);;
  305 :   if(iter>=npen){  // modify gradient when using a penalization
  306 :          dTheta
  187 @
  188 @
  189 @
  190 @
  191 @
  187 @    gradtheta  =
  188 @     (dlp  (alpha-beta)*(cos(ang)^2*dx(u)-cos(ang)*sin(ang)*dy(u))
  189 @     +dlm  (-(1/alpha-1/beta)/(1/alpha*theta+1/beta*(1-theta))^2)*(sin(ang)^2*dx(u)+cos(ang)*sin(ang)*dy(u)))*dx(ê±mp)
  190 @    +(dlp  (alpha-beta)*(-cos(ang)*sin(ang)*dx(u)+sin(ang)^2*dy(u))
  191 @     +dlm  (-(1/alpha-1/beta)/(1/alpha*theta+1/beta*(1-theta))^2)*(sin(ang)*cos(ang)*dx(u)+cos(ang)^2*dy(u)))*dy(ê±mp);;
  307 :          gradtheta = gradtheta+Cpen*(1-2*theta);
  308 :   }
  309 :   else{
  310 :     dTheta
  187 @
  188 @
  189 @
  190 @
  191 @
  187 @    gradtheta  =
  188 @     (dlp  (alpha-beta)*(cos(ang)^2*dx(u)-cos(ang)*sin(ang)*dy(u))
  189 @     +dlm  (-(1/alpha-1/beta)/(1/alpha*theta+1/beta*(1-theta))^2)*(sin(ang)^2*dx(u)+cos(ang)*sin(ang)*dy(u)))*dx(ê±mp)
  190 @    +(dlp  (alpha-beta)*(-cos(ang)*sin(ang)*dx(u)+sin(ang)^2*dy(u))
  191 @     +dlm  (-(1/alpha-1/beta)/(1/alpha*theta+1/beta*(1-theta))^2)*(sin(ang)*cos(ang)*dx(u)+cos(ang)^2*dy(u)))*dy(ê±mp);;
  311 :   }
  312 : };
  313 :
  314 : volume = int2d(Th)(theta);
  315 :
  316 :
  317 :
  318 : cout << volume << " " << volume0 << endl;
  319 : cout << "Min theta=" << theta[].min << " Max theta=" << theta[].max << endl;
  320 :
  321 : };
  322 :
  323 : // End of loop. Show the result  //
  324 :
  325 : //Show the final shape
  326 : legende="Final shape, Iteration "+iter+", Cost "+objectif+", Volume="+volume;
  327 : Vh thetb = 1-theta;
  328 : plot(Th,thetb,fill=1,value=0,cmm=legende);
  329 :
  330 : //vals[vals.n] = vals[vals.n-1];
  331 :
  332 : // Show convergence curve
  333 : real[int] dis = 1:niter;
  334 : plot([dis,vals],cmm="Evolution of the objective function");
  335 :
  336 : // If the plot is not shown correctly in the window type + to fix the view
  337 : // With P and Enter you can go to previous and next plots
  338 :
  339 :
  340 :  sizestack + 1024 =57992  ( 56968 )
 
Initialization. Objective: 0.434509 Volume: 0.699999
Gradient: 1.95156
First step 0.1
Iteration 1 ----------------------------------------
          Grad comparison: 1.86387 0.578429
          New step=0.11
    Objective: 0.414376
    Volume: 0
0.699997 0.699999
Min theta=0.699997 Max theta=0.699997
Iteration 2 ----------------------------------------
          Grad comparison: 1.83618 0.388982
          New step=0.121
    Objective: 0.339351
    Volume: 0.699997
0.699999 0.699999
Min theta=0.0980258 Max theta=0.796975
Iteration 3 ----------------------------------------
          Grad comparison: 0.817694 0.170804
          New step=0.1331
    Objective: 0.324696
    Volume: 0.699999
0.699998 0.699999
Min theta=0.0874942 Max theta=0.883406
Iteration 4 ----------------------------------------
          Grad comparison: 0.760138 0.128267
          New step=0.14641
    Objective: 0.314332
    Volume: 0.699998
0.699914 0.699999
Min theta=0.0904595 Max theta=0.972811
Iteration 5 ----------------------------------------
          Grad comparison: 0.719613 0.104295
          New step=0.161051
    Objective: 0.307201
    Volume: 0.699914
0.699998 0.699999
Min theta=0.0969682 Max theta=1
Iteration 6 ----------------------------------------
          Grad comparison: 0.695688 0.0871816
          New step=0.177156
    Objective: 0.303572
    Volume: 0.699998
0.699998 0.699999
Min theta=0.107914 Max theta=1
Iteration 7 ----------------------------------------
          Grad comparison: 0.686198 0.0734459
          New step=0.194872
    Objective: 0.301423
    Volume: 0.699998
0.699998 0.699999
Min theta=0.119559 Max theta=1
Iteration 8 ----------------------------------------
          Grad comparison: 0.682471 0.0622877
          New step=0.214359
    Objective: 0.30009
    Volume: 0.699998
0.699999 0.699999
Min theta=0.13216 Max theta=1
Iteration 9 ----------------------------------------
          Grad comparison: 0.681257 0.0528773
          New step=0.235795
    Objective: 0.299298
    Volume: 0.699999
0.699998 0.699999
Min theta=0.145907 Max theta=1
Iteration 10 ----------------------------------------
          Grad comparison: 0.681469 0.0445918
          New step=0.259374
    Objective: 0.298848
    Volume: 0.699998
0.699996 0.699999
Min theta=0.160681 Max theta=1
Iteration 11 ----------------------------------------
          Grad comparison: 0.682392 0.0372337
          New step=0.285312
    Objective: 0.298682
    Volume: 0.699996
0.699998 0.699999
Min theta=0.176626 Max theta=1
Iteration 12 ----------------------------------------
          Grad comparison: 0.684009 0.0306844
==========REJECT: new step=0.142656
==========Cost: 0.298755 Old cost: 0.298682  Volume: 0.699998
0.699998 0.699999
Min theta=0.176626 Max theta=1
Iteration 13 ----------------------------------------
          Grad comparison: 0.684009 0.0306844
          New step=0.156921
    Objective: 0.297018
    Volume: 0.699998
0.699999 0.699999
Min theta=0.100361 Max theta=1
Iteration 14 ----------------------------------------
          Grad comparison: 0.674843 0.0273202
          New step=0.172614
    Objective: 0.296913
    Volume: 0.699999
0.699997 0.699999
Min theta=0.109235 Max theta=1
Iteration 15 ----------------------------------------
          Grad comparison: 0.675542 0.0246289
==========REJECT: new step=0.0863068
==========Cost: 0.296928 Old cost: 0.296913  Volume: 0.699997
0.699997 0.699999
Min theta=0.109235 Max theta=1
Iteration 16 ----------------------------------------
          Grad comparison: 0.675542 0.0246289
          New step=0.0949375
    Objective: 0.296127
    Volume: 0.699997
0.699997 0.699999
Min theta=0.061662 Max theta=1
Iteration 17 ----------------------------------------
          Grad comparison: 0.671836 0.0232757
          New step=0.104431
    Objective: 0.296059
    Volume: 0.699997
0.699999 0.699999
Min theta=0.0670208 Max theta=1
Iteration 18 ----------------------------------------
          Grad comparison: 0.672135 0.0219357
          New step=0.114874
    Objective: 0.296053
    Volume: 0.699999
0.699999 0.699999
Min theta=0.0733893 Max theta=1
Iteration 19 ----------------------------------------
          Grad comparison: 0.6724 0.0206232
==========REJECT: new step=0.0574372
==========Cost: 0.296071 Old cost: 0.296053  Volume: 0.699999
0.699999 0.699999
Min theta=0.0733893 Max theta=1
Iteration 20 ----------------------------------------
          Grad comparison: 0.6724 0.0206232
          New step=0.0631809
    Objective: 0.2956
    Volume: 0.699999
0.699999 0.699999
Min theta=0.0415351 Max theta=1
Iteration 21 ----------------------------------------
          Grad comparison: 0.670473 0.0199265
          New step=0.069499
    Objective: 0.295558
    Volume: 0.699999
0.699998 0.699999
Min theta=0.0451177 Max theta=1
Iteration 22 ----------------------------------------
          Grad comparison: 0.670643 0.0191798
          New step=0.0764489
    Objective: 0.295546
    Volume: 0.699998
0.699981 0.699999
Min theta=0.0493396 Max theta=1
Iteration 23 ----------------------------------------
          Grad comparison: 0.670664 0.018452
==========REJECT: new step=0.0382244
==========Cost: 0.295573 Old cost: 0.295546  Volume: 0.699981
0.699981 0.699999
Min theta=0.0493396 Max theta=1
Iteration 24 ----------------------------------------
          Grad comparison: 0.670664 0.018452
          New step=0.0420469
    Objective: 0.295284
    Volume: 0.699981
0.699998 0.699999
Min theta=0.0280585 Max theta=1
Iteration 25 ----------------------------------------
          Grad comparison: 0.669659 0.0180492
          New step=0.0462516
    Objective: 0.295257
    Volume: 0.699998
0.699998 0.699999
Min theta=0.0304384 Max theta=1
Iteration 26 ----------------------------------------
          Grad comparison: 0.669748 0.0176169
          New step=0.0508767
    Objective: 0.295256
    Volume: 0.699998
0.699997 0.699999
Min theta=0.0332644 Max theta=1
Iteration 27 ----------------------------------------
          Grad comparison: 0.669788 0.0171764
==========REJECT: new step=0.0254384
==========Cost: 0.295265 Old cost: 0.295256  Volume: 0.699997
0.699997 0.699999
Min theta=0.0332644 Max theta=1
Iteration 28 ----------------------------------------
          Grad comparison: 0.669788 0.0171764
          New step=0.0279822
    Objective: 0.295086
    Volume: 0.699997
0.699998 0.699999
Min theta=0.0190226 Max theta=1
Iteration 29 ----------------------------------------
          Grad comparison: 0.669172 0.0169285
          New step=0.0307804
    Objective: 0.295067
    Volume: 0.699998
0.699999 0.699999
Min theta=0.0206244 Max theta=1
Iteration 30 ----------------------------------------
          Grad comparison: 0.669218 0.0166675
          New step=0.0338585
    Objective: 0.295066
    Volume: 0.699999
0.699997 0.699999
Min theta=0.0225037 Max theta=1
Iteration 31 ----------------------------------------
          Grad comparison: 0.669236 0.0163934
==========REJECT: new step=0.0169292
==========Cost: 0.295073 Old cost: 0.295066  Volume: 0.699997
0.699997 0.699999
Min theta=0.0225037 Max theta=1
Iteration 32 ----------------------------------------
          Grad comparison: 0.669236 0.0163934
          New step=0.0186222
    Objective: 0.294958
    Volume: 0.699997
0.699998 0.699999
Min theta=0.0130044 Max theta=1
Iteration 33 ----------------------------------------
          Grad comparison: 0.668865 0.0162381
          New step=0.0204844
    Objective: 0.294946
    Volume: 0.699998
0.699999 0.699999
Min theta=0.0140756 Max theta=1
Iteration 34 ----------------------------------------
          Grad comparison: 0.668894 0.0160759
          New step=0.0225328
    Objective: 0.294945
    Volume: 0.699999
0.699997 0.699999
Min theta=0.0153241 Max theta=1
Iteration 35 ----------------------------------------
          Grad comparison: 0.668901 0.0159022
==========REJECT: new step=0.0112664
==========Cost: 0.294949 Old cost: 0.294945  Volume: 0.699997
0.699997 0.699999
Min theta=0.0153241 Max theta=1
Iteration 36 ----------------------------------------
          Grad comparison: 0.668901 0.0159022
          New step=0.012393
    Objective: 0.294875
    Volume: 0.699997
0.699998 0.699999
Min theta=0.0089941 Max theta=1
Iteration 37 ----------------------------------------
          Grad comparison: 0.668675 0.0158036
          New step=0.0136323
    Objective: 0.294866
    Volume: 0.699998
0.699998 0.699999
Min theta=0.00970635 Max theta=1
Iteration 38 ----------------------------------------
          Grad comparison: 0.668687 0.0157006
==========REJECT: new step=0.00681617
==========Cost: 0.294867 Old cost: 0.294866  Volume: 0.699998
0.699998 0.699999
Min theta=0.00970635 Max theta=1
Iteration 39 ----------------------------------------
          Grad comparison: 0.668687 0.0157006
          New step=0.00749779
    Objective: 0.294811
    Volume: 0.699998
0.699981 0.699999
Min theta=0.00581622 Max theta=1
Iteration 40 ----------------------------------------
          Grad comparison: 0.668493 0.0156408
==========REJECT: new step=0.0037489
==========Cost: 0.294819 Old cost: 0.294811  Volume: 0.699981
0.699981 0.699999
Min theta=0.00581622 Max theta=1
Iteration 41 ----------------------------------------
          Grad comparison: 0.668493 0.0156408
          New step=0.00412378
    Objective: 0.294801
    Volume: 0.699981
0.699998 0.699999
Min theta=0.00368236 Max theta=1
Iteration 42 ----------------------------------------
          Grad comparison: 0.668482 0.015611
          New step=0.00453616
    Objective: 0.294795
    Volume: 0.699998
0.699998 0.699999
Min theta=0.00390834 Max theta=1
Iteration 43 ----------------------------------------
          Grad comparison: 0.668486 0.0155772
          New step=0.00498978
    Objective: 0.294792
    Volume: 0.699998
0.699997 0.699999
Min theta=0.0041858 Max theta=1
Iteration 44 ----------------------------------------
          Grad comparison: 0.668489 0.0155408
==========REJECT: new step=0.00249489
==========Cost: 0.294792 Old cost: 0.294792  Volume: 0.699997
0.699997 0.699999
Min theta=0.0041858 Max theta=1
Iteration 45 ----------------------------------------
          Grad comparison: 0.668489 0.0155408
          New step=0.00274438
    Objective: 0.294778
    Volume: 0.699997
0.699999 0.699999
Min theta=0.00277276 Max theta=1
Iteration 46 ----------------------------------------
          Grad comparison: 0.668448 0.0155203
          New step=0.00301882
    Objective: 0.294776
    Volume: 0.699999
0.699998 0.699999
Min theta=0.00293008 Max theta=1
Iteration 47 ----------------------------------------
          Grad comparison: 0.668449 0.0154983
          New step=0.0033207
    Objective: 0.294774
    Volume: 0.699998
0.699997 0.699999
Min theta=0.00311601 Max theta=1
Iteration 48 ----------------------------------------
          Grad comparison: 0.668448 0.0154739
          New step=0.00365277
    Objective: 0.294774
    Volume: 0.699997
0.699997 0.699999
Min theta=0.00332768 Max theta=1
Iteration 49 ----------------------------------------
          Grad comparison: 0.668451 0.0154472
          New step=0.00401804
    Objective: 0.294769
    Volume: 0.699997
0.69999 0.699999
Min theta=0.00355079 Max theta=1
Iteration 50 ----------------------------------------
          Grad comparison: 0.668429 0.0154173
          New step=0.00441985
    Objective: 0.445928
    Volume: 0.69999
0.699981 0.699999
Min theta=0.00380251 Max theta=1
Iteration 51 ----------------------------------------
          Grad comparison: 0.68543 0.0153842
          New step=0.00486183
    Objective: 0.445348
    Volume: 0.699981
0.699999 0.699999
Min theta=0.00290781 Max theta=1
Iteration 52 ----------------------------------------
          Grad comparison: 0.686628 0.0157139
          New step=0.00534802
    Objective: 0.44478
    Volume: 0.699999
0.699999 0.699999
Min theta=0.00305255 Max theta=1
Iteration 53 ----------------------------------------
          Grad comparison: 0.687909 0.0160817
          New step=0.00588282
    Objective: 0.444186
    Volume: 0.699999
0.699998 0.699999
Min theta=0.00327325 Max theta=1
Iteration 54 ----------------------------------------
          Grad comparison: 0.689285 0.0164898
          New step=0.0064711
    Objective: 0.443554
    Volume: 0.699998
0.699999 0.699999
Min theta=0.00352404 Max theta=1
Iteration 55 ----------------------------------------
          Grad comparison: 0.690776 0.0169435
          New step=0.00711821
    Objective: 0.442879
    Volume: 0.699999
0.699997 0.699999
Min theta=0.00380343 Max theta=1
Iteration 56 ----------------------------------------
          Grad comparison: 0.692401 0.0174452
          New step=0.00783003
    Objective: 0.442155
    Volume: 0.699997
0.699995 0.699999
Min theta=0.00411837 Max theta=1
Iteration 57 ----------------------------------------
          Grad comparison: 0.694176 0.0179984
          New step=0.00861304
    Objective: 0.441388
    Volume: 0.699995
0.699998 0.699999
Min theta=0.00446417 Max theta=1
Iteration 58 ----------------------------------------
          Grad comparison: 0.696102 0.01861
          New step=0.00947434
    Objective: 0.440566
    Volume: 0.699998
0.699998 0.699999
Min theta=0.00485037 Max theta=1
Iteration 59 ----------------------------------------
          Grad comparison: 0.698205 0.0192787
          New step=0.0104218
    Objective: 0.43969
    Volume: 0.699998
0.699998 0.699999
Min theta=0.00527769 Max theta=1
Iteration 60 ----------------------------------------
          Grad comparison: 0.700497 0.0200069
          New step=0.011464
    Objective: 0.438757
    Volume: 0.699998
0.699999 0.699999
Min theta=0.00575817 Max theta=1
Iteration 61 ----------------------------------------
          Grad comparison: 0.703003 0.0207974
          New step=0.0126103
    Objective: 0.437763
    Volume: 0.699999
0.699999 0.699999
Min theta=0.00628065 Max theta=1
Iteration 62 ----------------------------------------
          Grad comparison: 0.705737 0.0216549
 try getConsole F:\github-clone\MAP562-homework\PC8\radiator_compliance.edp
